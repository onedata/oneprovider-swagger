post:
  operationId: schedule_workflow_execution
  x-onedata-parse_body: as_json_params
  x-onedata-gri:
    type: op_atm_workflow_execution
    aspect: instance
  summary: Schedule workflow execution
  tags:
    - Workflow execution
  x-bash-codegen-description: |
    Schedules a workflow execution based on specified workflow schema.
    The execution is asynchronous.

    This operation requires `space_schedule_atm_workflow_executions` privilege and
    the requesting user must belong to the automation inventory containing the
    corresponding workflow schema definition.

  description: |
    Schedules a workflow execution based on specified workflow schema.
    The execution is asynchronous.

    This operation requires `space_schedule_atm_workflow_executions` privilege and
    the requesting user must belong to the automation inventory containing the
    corresponding workflow schema definition.

    ***Example cURL requests***

    **Create workflow execution**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" -X POST "https://$PROVIDER_HOST/api/v3/oneprovider/automation/execution/workflows" \
    -H "Content-Type: application/json" -d '{
        "spaceId": "'$SPACE_ID'",
        "atmWorkflowSchemaId": "'$ATM_WORKFLOW_SCHEMA_ID'",
        "storeInitialValues": {
            "de6d2e524459dd235f80aa8652a68879b5dbe9": [
                {
                    "file_id": "0000000000523261677569642330376134636136616638613431366334386338343366356338643562323662"
                }
            ],
            "83cf895501eb11f9bc71e4b2b41a252e8561b5": {
                "file_id": "000000000052A6E0677569642334653938663463616538386232366437366539636462393634633031653733"
            }
        }
        "callback": "https://my-server.example.com/execution-callback"
    }'
    ```
  consumes:
    - application/json
  produces:
    - application/json
  responses:
    '201':
      description: >
        The request has been accepted and the result is the workflow execution Id.
        Also URI of the workflow execution in form
        `https://$PROVIDER_HOST/api/v3/oneprovider/automation/execution/workflows/{id}`
        is returned in the response `Location` header.
      headers:
        Location:
          description: URI of the workflow execution.
          type: string
      schema:
        type: object
        properties:
          atmWorkflowExecutionId:
            type: string
            description: Workflow execution Id.
    '400':
      description: Invalid request.
      schema:
        $ref: '#/definitions/Error'
    '403':
      description: Forbidden request.
      schema:
        $ref: '#/definitions/Error'
    '404':
      description: Workflow execution with provided Id was not found.
      schema:
        $ref: '#/definitions/Error'
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
  parameters:
    - name: data
      in: body
      description: Workflow execution properties.
      schema:
        $ref: '#/definitions/AtmWorkflowExecutionScheduleRequest'
      required: true
  x-code-samples:
    - lang: Shell
      source: "oneprovider-rest-cli scheduleWorkflowExecution spaceId==$SPACE_ID atmWorkflowSchemaId==$ATM_WORKFLOW_SCHEMA_ID callback==https://my-server.example.com/execution-callback"
