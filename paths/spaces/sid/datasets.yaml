get:
  operationId: list_space_top_datasets
  x-onedata-gri:
    type: op_space
    id: ?BINDING(sid)
    aspect: datasets
  tags:
    - Dataset
  summary: List space top datasets
  x-bash-codegen-description: |
    Returns the list of space top datasets. Top datasets are those that have no parent
    dataset between them and space directory. In special case, when dataset has
    been established for space directory, there is only one top dataset.

    For each space, there exist 2 datasets trees:
    * one for datasets in `attached` state - this tree corresponds to compressed
      files tree for space meaning that dataset A is child of dataset B because
      B's root directory is ancestor to A's root file and no directory between
      them is root of some dataset or if is that dataset is in `detached` state.
      That also means that when moving dataset's root file to other location
      the dataset location in tree may also change.

    * one for datasets in `detached` state - this tree is effectively frozen and
      doesn't change when datasets' root files are moved around in files tree.

  description: |
    Returns the list of space top datasets. Top datasets are those that have no parent
    dataset between them and space directory. In special case, when dataset has
    been established for space directory, there is only one top dataset.

    For each space, there exist 2 datasets trees:
    * one for datasets in `attached` state - this tree corresponds to compressed
      files tree for space meaning that dataset A is child of dataset B because
      B's root directory is ancestor to A's root file and no directory between
      them is root of some dataset or if is that dataset is in `detached` state.
      That also means that when moving dataset's root file to other location
      the dataset location in tree may also change.

    * one for datasets in `detached` state - this tree is effectively frozen and
      doesn't change when datasets' root files are moved around in files tree.

    ***Example cURL requests***

    **List space top datasets**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" \
    -X GET "https://$HOST/api/v3/oneprovider/spaces/$SPACE_ID/datasets?state=attached"

    {
        "datasets": [
            "1f4b762b1380946e73aeca574c77f14c",
            "64233339643236366165646365626666"
        ],
        "isLast": true
    }
    ```
  produces:
    - application/json
  responses:
    '200':
      description: The list of space top datasets.
      schema:
        $ref: '#/definitions/Datasets'
    '400':
      description: Invalid request.
      schema:
        $ref: '#/definitions/Error'
    '403':
      description: Forbidden request.
      schema:
        $ref: '#/definitions/Error'
    '404':
      description: Invalid path - space not found.
      schema:
        $ref: '#/definitions/Error'
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
  parameters:
    - name: sid
      in: path
      description: Space Id
      type: string
      required: true
    - name: state
      in: query
      description: Specifies dataset tree to list from.
      type: string
      required: false
      default: attached
    - name: limit
      in: query
      description: >
        Allows specifying maximum number of entries that should be returned. If there are more
        datasets, they can be retrieved using `index` and `offset` query parameters.
      type: integer
      required: false
      maximum: 1000
      minimum: 1
      default: 1000
    - name: offset
      in: query
      description: >
        Offset from beginning of collection or given `index` specifying starting point for listing.
      type: integer
      required: false
      default: 0
    - name: index
      in: query
      description: >
        Index of the partial result, can be used to get subset of the result
        starting from specific dataset Id.
      type: string
      required: false
  x-code-samples:
  - lang: Shell
    source: "oneprovider-rest-cli listSpaceTopDatasets sid=$SPACE_ID limit=100 offset=300"
