delete:
  operationId: remove_file
  x-onedata-gri:
    type: op_file
    id: ?OBJECTID_BINDING(id)
    aspect: instance
  tags:
    - Basic File Operations
  summary: Remove file
  x-bash-codegen-description: |
    Removes file specified by [$FILE_ID](#operation/lookup_file_id).
    In case of a directory, all its children are recursively removed - note that
    the operation will fail part-way if the client does not have permissions to
    remove some of the nested files/directories.

  description: |
    Removes file specified by [$FILE_ID](#operation/lookup_file_id).
    In case of a directory, all its children are recursively removed - note that
    the operation will fail part-way if the client does not have permissions to
    remove some of the nested files/directories.

    ***Example cURL requests***

    **Remove specific file**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" -X DELETE "https://$PROVIDER_HOST/api/v3/oneprovider/data/$FILE_ID"
    ```
    See also [Remove file at path](#operation/remove_file_at_path).

  responses:
    '204':
      description: The file has been removed.
    '400':
      description: Invalid request.
      schema:
        $ref: '#/definitions/Error'
    '403':
      description: Forbidden request.
      schema:
        $ref: '#/definitions/Error'
    '404':
      description: File not found.
      schema:
        $ref: '#/definitions/Error'
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
  parameters:
    - name: id
      in: path
      description: File or directory Id
      type: string
      required: true
  x-code-samples:
    - lang: Shell
      source: "oneprovider-rest-cli removeFile id=$FILE_ID"


# TODO VFS-11377 remove deprecated values after next major release
get:
  operationId: get_attrs
  x-onedata-parse_body: as_json_params
  x-onedata-gri:
    type: op_file
    id: ?OBJECTID_BINDING(id)
    aspect: instance
  summary: Get file attributes
  tags:
    - Basic File Operations
  x-bash-codegen-description: |
    This method returns attributes of a file specified by [$FILE_ID](#operation/lookup_file_id).
    By default, all attributes are returned, except for extended attributes.
    The list of requested attributes can be optionally narrowed down, and extended attributes can be retrieved
    using the `xattr.*` attribute(s) (where * is an extended attribute key).
    
    **NOTE**: since version **21.02.5**, this endpoint accepts **options as JSON body** rather than in the query string.
    Moreover, some of the attributes have been renamed and the list of available ones has been extended.
    The old behaviour of the endpoint has been retained but is **DEPRECATED** and scheduled for
    deletion in the future major release. The following changes in attribute names were introduced:
    * `file_id` -> `fileId`
    * `mode` -> `posixPermissions`
    * `parent_id` -> `parentFileId`
    * `storage_group_id` -> `displayGid`
    * `storage_user_id` -> `displayUid`
    * `is_fully_replicated` -> `isFullyReplicatedLocally`
    * `provider_id` -> `originProviderId`
    * `shares` -> `directShareIds`
    * `owner_id` -> `ownerUserId`
    * `hardlinks_count` -> `hardlinkCount`

  description: |
    This method returns attributes of a file specified by [$FILE_ID](#operation/lookup_file_id).
    By default, all attributes are returned, except for extended attributes.
    The list of requested attributes can be optionally narrowed down, and extended attributes can be retrieved
    using the `xattr.*` attribute(s) (where * is an extended attribute key).
    
    **NOTE**: since version **21.02.5**, this endpoint accepts **options as JSON body** rather than in the query string.
    Moreover, some of the attributes have been renamed and the list of available ones has been extended.
    The old behaviour of the endpoint has been retained but is **DEPRECATED** and scheduled for
    deletion in the future major release. The following changes in attribute names were introduced:
    * `file_id` -> `fileId`
    * `mode` -> `posixPermissions`
    * `parent_id` -> `parentFileId`
    * `storage_group_id` -> `displayGid`
    * `storage_user_id` -> `displayUid`
    * `is_fully_replicated` -> `isFullyReplicatedLocally`
    * `provider_id` -> `originProviderId`
    * `shares` -> `directShareIds`
    * `owner_id` -> `ownerUserId`
    * `hardlinks_count` -> `hardlinkCount`

    ***Example cURL requests***

    **Get selected file attributes**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" -H 'Content-type: application/json' \
    -X GET "https://$PROVIDER_HOST/api/v3/oneprovider/data/$FILE_ID" -d '{
      "attributes": ["name", "size", "xattr.key"]
    }'

    {
        "name": "File1.txt",
        "size": 100,
        "xattr.key": "extended_attribute_value"
    }
    ```
  consumes:
    - application/json
  produces:
    - application/json
  responses:
    '200':
      description: Returns the requested file attributes.
      schema:
        $ref: '#/definitions/FileAttributes'
    '400':
      description: Invalid request.
      schema:
        $ref: '#/definitions/Error'
    '403':
      description: Forbidden request.
      schema:
        $ref: '#/definitions/Error'
    '404':
      description: File not found.
      schema:
        $ref: '#/definitions/Error'
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
  parameters:
    - name: id
      in: path
      description: File, directory or space Id.
      type: string
      required: true

    - name: data
      in: body
      required: false
      schema:
        type: object
        description: Get file attributes request.
        properties:
          attributes:
            $ref: '#/definitions/FileAttributeNames'

    - name: legacy_options
      in: query
      required: false
      description: >
        The old behaviour of the endpoint has been retained but is **DEPRECATED** and scheduled for
        deletion in the future major release. You may refer to the 
        [docs for 21.02.4](https://onedata.org/#/home/api/21.02.3/oneprovider?anchor=operation/list_files_recursively),
        but it's recommended to use the new API with options as JSON body.
      type: string

  x-code-samples:
  - lang: Shell
    source: "oneprovider-rest-cli getAttrs id=$FILE_ID"


put:
  operationId: set_attr
  x-onedata-parse_body: as_json_params
  x-onedata-gri:
    type: op_file
    id: ?OBJECTID_BINDING(id)
    aspect: attrs
  summary: Set file attribute
  tags:
    - Basic File Operations
  x-bash-codegen-description: |
    This method allows to set a value of a regular file attribute
    for a file specified by [$FILE_ID](#operation/lookup_file_id).

    Currently only POSIX mode can be changed by
    sending:
    ```
      { "mode": "0777" }
    ```
    where the POSIX mode is specified in octal notation.

  description: |
    This method allows to set a value of a regular file attribute
    for a file specified by [$FILE_ID](#operation/lookup_file_id).

    Currently only POSIX mode can be changed by sending:
    ```
    { "mode": "0777" }
    ```
    where the POSIX mode is specified in octal notation.

    ***Example cURL requests***

    **Set file POSIX mode**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" -X PUT "https://$PROVIDER_HOST/api/v3/oneprovider/data/$FILE_ID" \
    -H 'Content-Type: application/json' -d '{ "mode": "0777" }'
    ```
  consumes:
    - application/json
  responses:
    '204':
      description: File attributes updated successfuly.
    '400':
      description: Invalid request.
      schema:
        $ref: '#/definitions/Error'
    '403':
      description: Forbidden request.
      schema:
        $ref: '#/definitions/Error'
    '404':
      description: File not found.
      schema:
        $ref: '#/definitions/Error'
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
  parameters:
  - name: id
    in: path
    description: File, directory or space Id
    type: string
    required: true
  - name: attribute
    in: body
    description: Attribute name and value.
    schema:
      type: object
      additionalProperties:
        type: string
  x-code-samples:
  - lang: Shell
    source: "echo '{\"mode\": \"0777\"}' | oneprovider-rest-cli setAttr id=$FILE_ID -"
